image: registry.gitlab.gnome.org/gnome/mutter/master:v1

stages:
 - build
 - test

build-mutter:
  stage: build
  script:
    - meson . build -Degl_device=true -Dwayland_eglstream=true -Dheadless_tests=enabled
    - ninja -C build
    - ninja -C build install
    - meson test -v -C build --suite cogl-headless
  # artifacts:
  #   paths:
  #     - build

# test-cogl:
#   stage: test
#   dependencies:
#     - build-mutter
#   artifacts:
#     paths:
#       - build
#   script:
#     - meson test -v -C build --suite cogl-headless

# test-clutter:
#   stage: test
#   dependencies:
#     - build-mutter
#   artifacts:
#     paths:
#       - build
#   script:
#     - meson test -v -C build --suite clutter-headless

# test-mutter:
#   stage: test
#   dependencies:
#     - build-mutter
#   artifacts:
#     paths:
#       - build
#   script:
#     - meson test -v -C build --suite mutter-headless
